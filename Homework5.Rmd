---
title: "Homework5_RChiaverini"
output: html_document
date: '2022-11-25'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(readr)
library(tidyverse)
library(lubridate)
library(nplyr)
homicides <- read_csv("homicide-data.csv")
```

## Making Graphs

```{r}
#creating separate y,m,d#
homicides_baltimore <- homicides %>% 
  mutate(city_name = str_c(city, state, sep = ",")) %>% 
  mutate(year = str_sub(reported_date, start = 1, end = 4)) %>% 
  mutate(month = str_sub(reported_date, start = 5, end = 6)) %>% 
  mutate(day = str_sub(reported_date, start = 7, end = 8)) %>% 
  mutate(date = str_c(year, month, day, sep = "/")) %>% 
  mutate(month_year = str_c(month, year, sep = "/")) %>% 
  filter(city == "Baltimore") 
```

```{r}
#making variables numeric

homicides_baltimore$year <- as.numeric(homicides_baltimore$year)
homicides_baltimore$month <- as.numeric(homicides_baltimore$month)
homicides_baltimore$day <- as.numeric(homicides_baltimore$day)
homicides_baltimore$date <- as.Date(homicides_baltimore$date)

```

```{r}
# making year month for Y axis

library(zoo)

hom_balt <- homicides_baltimore %>%
  mutate(yearmonth = as.yearmon(date, "%m/%Y"))

```


```{r}
hom_balt1 <- hom_balt %>%
  mutate(uid_new = str_sub(uid, start = 5, end = 10)) %>%
  mutate(obs = uid_new) 

hom_balt2 <- hom_balt1 %>% 
  mutate(season = case_when(
      month %in% 10:12 ~ "Fall",
      month %in%  1:3  ~ "Winter",
      month %in%  4:6  ~ "Spring",
      TRUE ~ "Summer"))

homicides_month <- hom_balt2 %>% 
  select(obs, city_name, year, date, yearmonth, month, season) %>% 
  group_by(yearmonth) %>% 
  summarize(monthly_homicides = n(),
            obs = obs,
            city_name = city_name,
            year = year,
            date = date,
            season = season)

```


```{r}
homicides_month %>% 
  ggplot() +
  geom_bar(aes(x = date, y = monthly_homicides, color = season)) + 
  labs(x = "Date", y = "Monthly Homicides", title = "Homicides in Baltimore, MD")
```

